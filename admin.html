<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文章管理 - snow's garage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="container mx-auto px-6 max-w-4xl">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">文章管理系统</h1>
            <p class="text-gray-600">添加新文章并管理现有内容</p>
            <a href="research.html" class="inline-block mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
                ← 返回研究页面
            </a>
        </div>
        
        <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">添加新文章</h2>
            
            <form id="addArticleForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">文章类型</label>
                        <select id="articleType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="neuroscience">Neuroscience</option>
                            <option value="mathematics">Mathematics</option>
                            <option value="books">Books</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">日期</label>
                        <input type="text" id="articleDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               value="" placeholder="Dec 15, 2024">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700">标题</label>
                    <input type="text" id="articleTitle" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                           placeholder="文章标题" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700">描述</label>
                    <textarea id="articleDescription" class="w-full p-3 border border-gray-300 rounded-lg h-32 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                              placeholder="文章描述" required></textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">标签（用逗号分隔）</label>
                        <input type="text" id="articleTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               placeholder="neural-networks,learning">
                        <p class="text-xs text-gray-500 mt-1">常用标签：computational-neuroscience, neural-networks, learning, memory, consciousness, review, linear-algebra, calculus, probability, statistics, optimization</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">图片文件名</label>
                        <input type="text" id="articleImage" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               placeholder="article-image.jpg">
                        <p class="text-xs text-gray-500 mt-1">请先将图片上传到 images/articles/ 目录</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">渐变样式</label>
                        <select id="articleGradient" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="from-blue-100 to-purple-100">蓝紫渐变</option>
                            <option value="from-green-100 to-blue-100">绿蓝渐变</option>
                            <option value="from-pink-100 to-purple-100">粉紫渐变</option>
                            <option value="from-yellow-100 to-orange-100">黄橙渐变</option>
                            <option value="from-red-100 to-pink-100">红粉渐变</option>
                            <option value="from-green-100 to-teal-100">绿青渐变</option>
                            <option value="from-blue-100 to-indigo-100">蓝靛渐变</option>
                            <option value="from-yellow-100 to-amber-100">黄琥珀渐变</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-700">图标颜色</label>
                        <select id="articleIconColor" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="text-blue-500">蓝色</option>
                            <option value="text-green-500">绿色</option>
                            <option value="text-pink-500">粉色</option>
                            <option value="text-yellow-500">黄色</option>
                            <option value="text-red-500">红色</option>
                            <option value="text-purple-500">紫色</option>
                            <option value="text-indigo-500">靛色</option>
                            <option value="text-teal-500">青色</option>
                        </select>
                    </div>
                </div>
                
                <!-- Books特有字段 -->
                <div id="bookFields" class="hidden space-y-4 p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-medium text-gray-700">书籍专用字段</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">作者</label>
                            <input type="text" id="bookAuthors" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                   placeholder="作者姓名">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">阅读进度（%）</label>
                            <input type="number" id="bookProgress" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                   min="0" max="100" value="0">
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors font-medium">
                    添加文章
                </button>
            </form>
        </div>
        
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">当前文章预览</h2>
            <div id="articlesPreview" class="space-y-4">
                <div class="text-center text-gray-500 py-8">
                    <p>正在加载文章列表...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/articles.js"></script>
    <script>
        // 设置默认日期
        document.getElementById('articleDate').value = new Date().toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });

        // 监听文章类型变化
        document.getElementById('articleType').addEventListener('change', function() {
            const bookFields = document.getElementById('bookFields');
            if (this.value === 'books') {
                bookFields.classList.remove('hidden');
            } else {
                bookFields.classList.add('hidden');
            }
        });

        // 处理表单提交
        document.getElementById('addArticleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = document.getElementById('articleType').value;
            let articleData;
            
            if (type === 'books') {
                articleData = {
                    title: document.getElementById('articleTitle').value,
                    authors: document.getElementById('bookAuthors').value,
                    description: document.getElementById('articleDescription').value,
                    progress: parseInt(document.getElementById('bookProgress').value),
                    image: document.getElementById('articleImage').value,
                    gradient: document.getElementById('articleGradient').value,
                    iconColor: document.getElementById('articleIconColor').value
                };
            } else {
                articleData = {
                    title: document.getElementById('articleTitle').value,
                    description: document.getElementById('articleDescription').value,
                    date: document.getElementById('articleDate').value,
                    tags: document.getElementById('articleTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                    image: document.getElementById('articleImage').value,
                    gradient: document.getElementById('articleGradient').value,
                    iconColor: document.getElementById('articleIconColor').value,
                    icon: "M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                };
            }
            
            // 等待articleManager加载完成
            if (articleManager) {
                articleManager.addArticle(type, articleData);
                
                // 清空表单
                this.reset();
                document.getElementById('articleDate').value = new Date().toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                // 隐藏书籍字段
                document.getElementById('bookFields').classList.add('hidden');
                
                alert('文章添加成功！JSON文件已下载，请替换 data/articles.json 文件。');
                
                // 刷新预览
                setTimeout(showArticlesPreview, 500);
            } else {
                alert('系统正在加载，请稍后再试。');
            }
        });
        
        // 预览现有文章
        function showArticlesPreview() {
            const preview = document.getElementById('articlesPreview');
            if (articleManager && articleManager.articles) {
                let html = '';
                
                // 显示神经科学文章
                if (articleManager.articles.neuroscience && articleManager.articles.neuroscience.length > 0) {
                    html += '<h3 class="text-lg font-bold text-blue-600 mb-2">Neuroscience (' + articleManager.articles.neuroscience.length + '篇)</h3>';
                    articleManager.articles.neuroscience.forEach(article => {
                        html += `<div class="p-3 border border-blue-200 rounded-lg bg-blue-50 mb-2">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <strong class="text-blue-800">${article.title}</strong> 
                                    <span class="text-blue-600">- ${article.date}</span>
                                    <br><span class="text-sm text-blue-600">${article.tags ? article.tags.join(', ') : '无标签'}</span>
                                </div>
                                <div class="ml-4 text-xs text-blue-500">
                                    <div>图片: ${article.image || '未设置'}</div>
                                    <div>ID: ${article.id}</div>
                                </div>
                            </div>
                        </div>`;
                    });
                }
                
                // 显示数学文章
                if (articleManager.articles.mathematics && articleManager.articles.mathematics.length > 0) {
                    html += '<h3 class="text-lg font-bold text-green-600 mb-2 mt-4">Mathematics (' + articleManager.articles.mathematics.length + '篇)</h3>';
                    articleManager.articles.mathematics.forEach(article => {
                        html += `<div class="p-3 border border-green-200 rounded-lg bg-green-50 mb-2">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <strong class="text-green-800">${article.title}</strong> 
                                    <span class="text-green-600">- ${article.date}</span>
                                    <br><span class="text-sm text-green-600">${article.tags ? article.tags.join(', ') : '无标签'}</span>
                                </div>
                                <div class="ml-4 text-xs text-green-500">
                                    <div>图片: ${article.image || '未设置'}</div>
                                    <div>ID: ${article.id}</div>
                                </div>
                            </div>
                        </div>`;
                    });
                }
                
                // 显示书籍
                if (articleManager.articles.books && articleManager.articles.books.length > 0) {
                    html += '<h3 class="text-lg font-bold text-purple-600 mb-2 mt-4">Books (' + articleManager.articles.books.length + '本)</h3>';
                    articleManager.articles.books.forEach(book => {
                        html += `<div class="p-3 border border-purple-200 rounded-lg bg-purple-50 mb-2">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <strong class="text-purple-800">${book.title}</strong> 
                                    <span class="text-purple-600">- ${book.authors}</span>
                                    <br><span class="text-sm text-purple-600">进度: ${book.progress}%</span>
                                </div>
                                <div class="ml-4 text-xs text-purple-500">
                                    <div>图片: ${book.image || '未设置'}</div>
                                    <div>ID: ${book.id}</div>
                                </div>
                            </div>
                        </div>`;
                    });
                }
                
                if (html === '') {
                    html = '<div class="text-center text-gray-500 py-8"><p>暂无文章</p></div>';
                }
                
                preview.innerHTML = html;
            } else {
                preview.innerHTML = '<div class="text-center text-gray-500 py-8"><p>正在加载文章列表...</p></div>';
            }
        }
        
        // 当文章管理器加载完成后显示预览
        let previewInterval = setInterval(() => {
            if (articleManager && articleManager.articles) {
                showArticlesPreview();
                clearInterval(previewInterval);
            }
        }, 100);
        
        // 5秒后如果还没加载成功，停止尝试
        setTimeout(() => {
            clearInterval(previewInterval);
        }, 5000);
    </script>
</body>
</html>
